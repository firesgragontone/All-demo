```java
    @Override
    public List<RelateCompanyImportExcelVO> readSheets(MultipartFile excelFile, CommonForm form) {
        List<RelateCompanyImportExcelVO> importExcelList;
        try {
            importExcelList = ExcelUtil.readExcel(excelFile, RelateCompanyImportExcelVO.class, 0);
        } catch (Exception e) {
            throw new BusinessException("Import excel Exception: [{}]", e);
        }
        ShiroSessionUser user = AdminShiroUtil.getUser();
        if (CollectionUtil.isNotEmpty(importExcelList)) {
            List<RelateCompany> insertList = new ArrayList<>();
            List<RelateCompany> updateList = new ArrayList<>();
            List<RelateCompany> finalUpdateList = updateList;
            List<RelateCompany> finalInsertList = insertList;
            importExcelList.forEach(e -> {
                LambdaQueryWrapper<RelateCompany> queryWrapper = new LambdaQueryWrapper<>();
                queryWrapper.eq(RelateCompany::getCompanyName, e.getCompanyName());
                RelateCompany company = relateCompanyService.getOne(queryWrapper);
                RelateCompany relateCompany = new RelateCompany();
                BeanUtil.copyProperties(e, relateCompany);
                relateCompany.setCreatorId(user.getId());
                if (ObjectUtil.isNotNull(company)) {
                    relateCompany.setId(company.getId());
                    finalUpdateList.add(relateCompany);
                } else {
                    finalInsertList.add(relateCompany);
                }
            });
            if (CollectionUtil.isNotEmpty(insertList)) {
                insertList = insertList.stream().filter(distinctByKey(RelateCompany::getCompanyName)).collect(Collectors.toList());
                relateCompanyService.removeAll();
                relateCompanyService.saveBatch(insertList);
            }
            if (CollectionUtil.isNotEmpty(updateList)) {
                updateList = updateList.stream().filter(distinctByKey(RelateCompany::getCompanyName)).collect(Collectors.toList());
                relateCompanyService.removeAll();
                relateCompanyService.updateBatchById(updateList);
            }
        }
        return importExcelList;
    }

    @Override
    public void afterPropertiesSet() throws Exception {

    }

    // 自定义去重方法
    static <T> Predicate<T> distinctByKey(Function<? super T, ?> keyExtractor) {
        Map<Object, Boolean> seen = new ConcurrentHashMap<>();
        return t -> seen.putIfAbsent(keyExtractor.apply(t), Boolean.TRUE) == null;
    }
```

